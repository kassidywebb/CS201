<!doctype html>
<html lang="en" class="no-js">
  <head>
    <title>5.4 Probabilistic analysis and further uses of indicator random variables</title>
    <meta name="description" content="Student Produced Course Help for The University of Alabama's CS 201 Course">
    <meta name="author" content="Kassidy Webb">
    <link rel="canonical" href="https://kassidywebb.github.io/cs201/">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="lang:clipboard.copy" content="Copy to clipboard">
    <meta name="lang:clipboard.copied" content="Copied to clipboard">
    <meta name="lang:search.language" content="en">
    <meta name="lang:search.pipeline.stopwords" content="True">
    <meta name="lang:search.pipeline.trimmer" content="True">
    <meta name="lang:search.result.none" content="No matching documents">
    <meta name="lang:search.result.one" content="1 matching document">
    <meta name="lang:search.result.other" content="# matching documents">
    <meta name="lang:search.tokenizer" content="[\s\-]+">
    <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#990000">


    <link rel="shortcut icon" href="../../../assets/favicon.png">
    <link rel="stylesheet" href="../../../assets/stylesheets/application.1b62728e.css">
    <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.a8b3c06d.css">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    <link rel="stylesheet" href="../../../css/katex.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">

    <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>

    <script src="../../../assets/javascripts/modernizr.268332fc.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    <script src="../../../js/chapters.js"></script>
    <script>
      window.ga = window.ga || function() {
      (ga.q = ga.q || []).push(arguments)
      }
      ga.l = +new Date
      /* Setup integration and send page view */
      ga("create", "UA-117404761-1", "auto")
      ga("set", "anonymizeIp", true)
      ga("send", "pageview")
      /* Register handler to log search on blur */
      document.addEventListener("DOMContentLoaded", () => {
      if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
      if (this.value) {
        var path = document.location.pathname;
        ga("send", "pageview", path + "?q=" + this.value)
      }
      })
      }
      })
    </script>
  </head>
  <body dir="ltr" data-md-color-primary="crimson" data-md-color-accent="cyan">
    <svg class="md-svg">
      <defs>
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
            viewBox="0 0 416 448" id="__github">
            <path fill="currentColor" d="M409.132,114.573c-19.608-33.596-46.205-60.194-79.798-79.8C295.736,15.166,259.057,5.365,219.271,5.365
            c-39.781,0-76.472,9.804-110.063,29.408c-33.596,19.605-60.192,46.204-79.8,79.8C9.803,148.168,0,184.854,0,224.63
            c0,47.78,13.94,90.745,41.827,128.906c27.884,38.164,63.906,64.572,108.063,79.227c5.14,0.954,8.945,0.283,11.419-1.996
            c2.475-2.282,3.711-5.14,3.711-8.562c0-0.571-0.049-5.708-0.144-15.417c-0.098-9.709-0.144-18.179-0.144-25.406l-6.567,1.136
            c-4.187,0.767-9.469,1.092-15.846,1c-6.374-0.089-12.991-0.757-19.842-1.999c-6.854-1.231-13.229-4.086-19.13-8.559
            c-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559
            c-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-0.951-2.568-2.098-3.711-3.429c-1.142-1.331-1.997-2.663-2.568-3.997
            c-0.572-1.335-0.098-2.43,1.427-3.289c1.525-0.859,4.281-1.276,8.28-1.276l5.708,0.853c3.807,0.763,8.516,3.042,14.133,6.851
            c5.614,3.806,10.229,8.754,13.846,14.842c4.38,7.806,9.657,13.754,15.846,17.847c6.184,4.093,12.419,6.136,18.699,6.136
            c6.28,0,11.704-0.476,16.274-1.423c4.565-0.952,8.848-2.383,12.847-4.285c1.713-12.758,6.377-22.559,13.988-29.41
            c-10.848-1.14-20.601-2.857-29.264-5.14c-8.658-2.286-17.605-5.996-26.835-11.14c-9.235-5.137-16.896-11.516-22.985-19.126
            c-6.09-7.614-11.088-17.61-14.987-29.979c-3.901-12.374-5.852-26.648-5.852-42.826c0-23.035,7.52-42.637,22.557-58.817
            c-7.044-17.318-6.379-36.732,1.997-58.24c5.52-1.715,13.706-0.428,24.554,3.853c10.85,4.283,18.794,7.952,23.84,10.994
            c5.046,3.041,9.089,5.618,12.135,7.708c17.705-4.947,35.976-7.421,54.818-7.421s37.117,2.474,54.823,7.421l10.849-6.849
            c7.419-4.57,16.18-8.758,26.262-12.565c10.088-3.805,17.802-4.853,23.134-3.138c8.562,21.509,9.325,40.922,2.279,58.24
            c15.036,16.18,22.559,35.787,22.559,58.817c0,16.178-1.958,30.497-5.853,42.966c-3.9,12.471-8.941,22.457-15.125,29.979
            c-6.191,7.521-13.901,13.85-23.131,18.986c-9.232,5.14-18.182,8.85-26.84,11.136c-8.662,2.286-18.415,4.004-29.263,5.146
            c9.894,8.562,14.842,22.077,14.842,40.539v60.237c0,3.422,1.19,6.279,3.572,8.562c2.379,2.279,6.136,2.95,11.276,1.995
            c44.163-14.653,80.185-41.062,108.068-79.226c27.88-38.161,41.825-81.126,41.825-128.906
            C438.536,184.851,428.728,148.168,409.132,114.573z" />
          </svg>
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>

    <!-- header code -->
    <div id="header"></div>

    <div class="md-container">
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">

          <!-- sidebar code -->
          <div id="sidebar"></div>

          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--secondary">
                  <label class="md-nav__title" for="__toc">Page Contents</label>
                  <ul class="md-nav__list" data-md-scrollfix>
                    <li class="md-nav__item">
                      <a href="#54-1" class="md-nav__link">
                        5.4-1
                      </a>
                      
                    </li>
                          
                            <li class="md-nav__item">
                      <a href="#54-2" class="md-nav__link">
                        5.4-2
                      </a>
                      
                    </li>
                          
                            <li class="md-nav__item">
                      <a href="#54-3-star" class="md-nav__link">
                        5.4-3 $\star$
                      </a>
                      
                    </li>
                          
                            <li class="md-nav__item">
                      <a href="#54-4-star" class="md-nav__link">
                        5.4-4 $\star$
                      </a>
                      
                    </li>
                          
                            <li class="md-nav__item">
                      <a href="#54-5-star" class="md-nav__link">
                        5.4-5 $\star$
                      </a>
                      
                    </li>
                          
                            <li class="md-nav__item">
                      <a href="#54-6-star" class="md-nav__link">
                        5.4-6 $\star$
                      </a>
                      
                    </li>
                          
                            <li class="md-nav__item">
                      <a href="#54-7-star" class="md-nav__link">
                        5.4-7 $\star$
                      </a>
                      
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <!-- page content -->
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              <h1>5.4 Probabilistic analysis and further uses of indicator random variables</h1>
                
                <h2 id="54-1">5.4-1</h2>
<blockquote>
<p>How many people must there be in a room before the probability that someone has the same birthday as you do is at least $1 / 2$? How many people must there be before the probability that at least two people have a birthday on July 4 is greater than $1 / 2$?</p>
</blockquote>
<p>The probability of a person not having the same birthday as me is $(n - 1) / n$. The probability of $k$ people not having the same birthday as me is that, squared. We apply the same approach as the text - we take the complementary event and solve it for $k$,</p>
<p>$$
\begin{aligned}
        1 - \big(\frac{n - 1}{k}\big)^k &amp; \ge \frac{1}{2} \\
            \big(\frac{n - 1}{k}\big)^k &amp; \le \frac{1}{2} \\
          k\lg\big(\frac{n - 1}{n}\big) &amp; \ge \lg\frac{1}{2} \\
k = \frac{\log(1 / 2)}{\log(364 / 365)} &amp; \approx 263.
\end{aligned}
$$</p>
<p>As for the other question,</p>
<p>$$
\begin{aligned}
\Pr\{\text{2 born on Jul 4}\}
    &amp; = 1 - \Pr\{\text{1 born on Jul 4}\} - \Pr\{\text{0 born on Jul 4}\} \\
    &amp; = 1 - \frac{k}{n}\big(\frac{n - 1}{n}\big)^{k - 1} - \big(\frac{n - 1}{n}\big)^k \\
    &amp; = 1 - \big(\frac{n - 1}{n}\big)^{k - 1}\big(\frac{n + k - 1}{n}\big).
\end{aligned}
$$</p>
<p>Writing a Ruby programme to find the closest integer, we get $115$.</p>
<h2 id="54-2">5.4-2</h2>
<blockquote>
<p>Suppose that we toss balls into $b$ bins until some bin contains two balls. Each toss is independent, and each ball is equally likely to end up in any bin. What is the expected number of ball tosses?</p>
</blockquote>
<p>This is just a restatement of the birthday problem. I consider this all that needs to be said on this subject.</p>
<h2 id="54-3-star">5.4-3 $\star$</h2>
<blockquote>
<p>For the analysis of the birthday paradox, is it important that the birthdays be mutually independent, or is pairwise independence sufficient? Justify your answer.</p>
</blockquote>
<p>Pairwise independence is enough. It's sufficient for the derivation after $\text{(5.6)}$.</p>
<h2 id="54-4-star">5.4-4 $\star$</h2>
<blockquote>
<p>How many people should be invited to a party in order to make it likely that there are $three$ people with the same birthday?</p>
</blockquote>
<p>The answer is $88$. I reached it by trial and error. But let's analyze it with indicator random variables.</p>
<p>Let $X_{ijk}$ be the indicator random variable for the event of the people with indices $i$, $j$ and $k$ have the same birthday. The probability is $1 / n^2$. Then,</p>
<p>$$
\begin{aligned}
\text E[X]
    &amp; = \sum_{i = 1}^n\sum_{j = i + 1}^n \sum_{k = j + 1}^n X_{ijk} \\
    &amp; = \sum_{i = 1}^n\sum_{j = i + 1}^n \sum_{k = j + 1}^n \frac{1}{n^2} \\
    &amp; = \binom{n}{3}\frac{1}{n^2} \\
    &amp; = \frac{k(k - 1)(k - 2)}{6n^2}.
\end{aligned}
$$</p>
<p>Solving this yields $94$. It's a bit more, but again, indicator random variables are approximate.</p>
<p>Finding more commentary online is tricky.</p>
<h2 id="54-5-star">5.4-5 $\star$</h2>
<blockquote>
<p>What is the probability that a $k$-string over a set of size $n$ forms a $k$-permutation? How does this question relate to the birthday paradox?</p>
</blockquote>
<p>$$
\begin{aligned}
\Pr\{k\text{-perm in }n\}
    &amp; = 1 \cdot \frac{n - 1}{n} \cdot \frac{n - 2}{n} \cdots \frac{n - k + 1}{n} \\
    &amp; = \frac{(n - 1)!}{(n - k)!n^k}.
\end{aligned}
$$</p>
<p>This is the complementary event to the birthday problem, that is, the chance of $k$ people have distinct birthdays.</p>
<h2 id="54-6-star">5.4-6 $\star$</h2>
<blockquote>
<p>Suppose that $n$ balls are tossed into $n$ bins, where each toss is independent and the ball is equally likely to end up in any bin. What is the expected number of empty bins? What is the expected number of bins with exactly one ball?</p>
</blockquote>
<p>Let $X_i$ be the indicator variable that bin $i$ is empty after all balls are tossed and $X$ be the random variable that gives the number of empty bins. Thus we have</p>
<p>$$E[X] = \sum_{i = 1}^n E[X_i] = \sum_{i = 1}^n \bigg(\frac{n - 1}{n}\bigg)^n = n\bigg(\frac{n - 1}{n}\bigg)^n.$$</p>
<p>Let $X_i$ be the indicator variable that bin $i$ contains exactly $1$ ball after all balls are tossed and $X$ be the random variable that gives the number of bins containing exactly $1$ ball. Thus we have</p>
<p>$$E[X] = \sum_{i = 1}^n E[X_i] = \sum_{i = 1}^n \binom{n}{1}\bigg(\frac{n - 1}{n}\bigg)^{n - 1} \frac{1}{n} = n\bigg(\frac{n - 1}{n}\bigg)^{n - 1},$$</p>
<p>because we need to choose which toss will go into bin $i$, then multiply by the probability that that toss goes into that bin and the remaining $n − 1$ tosses avoid it.</p>
<h2 id="54-7-star">5.4-7 $\star$</h2>
<blockquote>
<p>Sharpen the lower bound on streak length by showing that in $n$ flips of a fair coin, the probability is less than $1 / n$ that no streak longer than $\lg n - 2\lg\lg n$ consecutive heads occurs.</p>
</blockquote>
<p>We split up the n flips into $n / s$ groups where we pick $s = \lg(n) - 2 \lg(\lg(n))$. We will show that at least one of these groups comes up all heads with probability at least $\frac{n - 1}{n}$. So, the probability the group starting in position $i$ comes up all heads is</p>
<p>$$\Pr(A_{i,\lg n - 2\lg(\lg n)}) = \frac{1}{2^{\lg n - 2\lg(\lg n)}} = \frac{\lg n^2}{n}.$$</p>
<p>Since the groups are based of of disjoint sets of IID coin flips, these probabilities
are independent. so,</p>
<p>$$
\begin{aligned}
\Pr(\bigwedge\neg A_{i,\lg n - 2\lg(\lg n)})
    &amp; =   \prod_i\Pr(\neg A_{i,\lg n - 2\lg(\lg n)}) \\
    &amp; =   \Big(1-\frac{\lg n^2}{n}\Big)^{\frac{n}{\lg n - 2\lg(\lg n)}} \\
    &amp; \le e^{-\frac{\lg n^2}{\lg n - 2\lg(\lg n)}} \\ &amp;= \frac{1}{n} e^{\frac{-2\lg(\lg n)\lg n}{\lg n - 2\lg(\lg n)}} \\
    &amp; =   n^{-1-\frac{2\lg(\lg n)}{\lg n - 2\lg(\lg n)}} \\
&amp; &lt; n^{-1}.
\end{aligned}
$$</p>
<p>Showing that the probability that there is no run of length at least $\lg n - 2\lg(\lg n)$ to be $&lt; \frac{1}{n}$.</p>
                
            </article>
          </div>

        </div>
      </main>

      <!-- footer code -->
      <div id="footer"></div>

    </div>

    <script src="../../../assets/javascripts/application.808e90bb.js"></script>
    <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
    <script src="../../../js/katex.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>

  </body>
</html>